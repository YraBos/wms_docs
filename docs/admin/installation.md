---
title: 'Установка системы WMS'
---

Помимо установки lsFusion эти программы/скрипты установки также устанавливают OpenJDK, PostgresSQL и Tomcat. 
При этом Tomcat встраивается в установку lsFusion Client, а OpenJDK и PostgreSQL устанавливаются отдельно (в частности, в отдельные папки).


## Установка в ОС Windows

Исполняемые exe файлы:
lsFusion 4.1 Server & Client (+ OpenJDK 11.0.9, PostgresSQL 13.1(x64)/10.8(x32), Tomcat 9.0.21):

В дальнейшем $INSTALL_DIR$ - папка, выбранная при установке lsFusion (по умолчанию Program Files/lsFusion `<версия>`). 
Также предполагается, что все параметры (порты, имя веб-контекста) оставлены равными по умолчанию.


## Установка в ОС Linux
Bash скрипты с использованием yum/apt (в качестве минорных версий используются последние стабильные):
lsFusion 4 Server & Client (+ OpenJDK 1.8, PostgresSQL 13, Tomcat 9.0.21):

| **ОС**                        | **Команда/Скрипт**                                                                                                                                      |
|-------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------|
| RHEL 7 / CentOS 7 / Fedora 29 | source `<(curl -s https://download.lsfusion.org/yum/install-lsfusion4)`                                                                                 |
| Ubuntu 18 / Debian 9          | source `<(curl -s https://download.lsfusion.org/apt/install-lsfusion4)`<br/>PostgresSQL устанавливается версии 10, так как только он есть в репозитории |


## После установки

**Порты**
После того как установка завершится, по умолчанию, на компьютере будут локально установлены и запущены в качестве служб:
- сервер БД (PostgreSQL) на порту 5432
- сервер приложений (Server) на порту 7652
- веб-сервер (Client) на порту 8080

## Установка/обновление приложения
Для того чтобы загрузить разработанную логику на установленный сервер приложений (Server) необходимо поместить разработанные 
на языке lsFusion модули в виде файлов с расширением lsf в папку, находящуюся в classpath сервера 
(значение по умолчанию при автоматической установке см. ниже). 
Кроме того туда необходимо поместить остальные файлы ресурсов (если они есть, например, файлы отчетов, скомпилированные Java файлы, картинки и т.п.). 
Допускается помещать эти файлы в подпапки classpath'а, а также внутри jar-файлов (zip-архивов с расширением jar). 
После того как все файлы скопированы, необходимо перезапустить сервер.

>Часто бывает удобно поставлять все файлы проекта внутри одного jar-файла. 
Для того чтобы сформировать такой файл автоматически, можно использовать Maven (с профилями assemble и noserver) или средства сборки, встроенные в IDE.

$APP_DIR$ при этом равен:
- **Windows**  - $INSTALL_DIR$/lib
- **Linux** - /var/lib/lsfusion. Сервер приложений инсталлируется и запускается под автоматически создаваемым непривилегированным пользователем lsfusion, 
соответственно, файлы в этой папке должны быть доступны этому пользователю на чтение.


## Установка/обновление клиентов
Для того чтобы дать доступ пользователям к установленной системе необходимо:
Отправить пользователям ссылку `http://<сетевой адрес веб-сервера (Client)>:8080`. 
При открытии этой ссылки, пользователь, по умолчанию, будет перенаправлен на страницу логина, где он, в свою очередь, 
при необходимости, может установить себе десктоп-клиент через Java Web Start, предварительно установив себе Java (JDK) 
(например, по [этой](https://developers.redhat.com/products/openjdk/download) ссылке с регистрацией или по этой - [без](https://github.com/ojdkbuild/ojdkbuild)). 
Обновление веб и десктоп-клиентов происходит автоматически вместе с обновлением веб-сервера (Client).

>Под Windows также можно воспользоваться [программами установки](https://download.lsfusion.org/exe/) десктоп клиента 
(файлы lsfusion-desktop-* с нужной версией и разрядностью ОС). 
Однако в отличие от установки при помощи Java Web Start, установленный таким образом десктоп-клиент не будет автоматически обновляться. 
Соответственно для его ручного обновления необходимо скачать файл новой версии десктоп клиента 
(`lsfusion-client-4.<новая версия>.jar`) с центрального сервера и заместить им файл $INSTALL_DIR$/client.jar.


## Обновление
>Здесь и далее все пути и команды приведены для мажорной версии платформы номер 4 
(соответственно для других версий необходимо просто заменить 4 на нужное число, например lsfusion4-server → lsfusion11-server). 
Для **Windows** все пути приведены по умолчанию.  Для Linux пути изменены (в частности при помощи symlink'ов) в соответствии с идеологией Linux.

Программы устанавливаемые отдельно (OpenJDK, PostgreSQL) обновляются также отдельно (более подробная об этом процессе в документации к соответствующим программам)  
Компоненты платформы также обновляются отдельно друг от друга. Чтобы сделать это необходимо:  
- **Windows** - скачать файл новой версии компоненты с центрального сервера и заместить им следующий файл:

| **Компонент**                  | **Файлы**                                                                                                                                                                                                                                                                                                        |
|--------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Сервер приложений<br/>(Server) | Файл на центральном сервере: `lsfusion-server-4.<новая версия>.jar`<br/>Замещаемый файл: $INSTALL_DIR$/Server/server.jar                                                                                                                                                                                         |
| Веб-сервер (Client)            | Файл на центральном сервере: `lsfusion-client-4.<новая версия>.war`<br/>Замещаемый файл: $INSTALL_DIR$/Client/webapps/ROOT.war<br/>Для обновления Tomcat, необходимо скачать архив с новой версией Tomcat и разархивировать его в папку $INSTALL_DIR$/Client без<br/>каталога webapps и файла параметров запуска |
<br/>
- **Linux** - выполнить подходящую команду:

| **Компонент**              | **ОС**                        | **Команда**                  |
|----------------------------|-------------------------------|------------------------------|
| Сервер приложений (Server) | RHEL 7 / CentOS 7 / Fedora 29 | yum update lsfusion4_server  |
| Сервер приложений (Server) | Ubuntu 18 / Debian 9          | apt install lsfusion4_server |
| Веб-сервер (Client)        | RHEL 7 / CentOS 7 / Fedora 29 | yum update lsfusion4_client  |
| Веб-сервер (Client)        | Ubuntu 18 / Debian 9          | apt install lsfusion4_client |


## Выборочная установка
Если какие-то из перечисленных в установке программ (компонент платформы) не надо устанавливать/уже установлены на вашем компьютере, 
для Windows эти программы можно исключить в процессе установки при помощи соответствующего графического интерфейса. 
На Linux для установки отдельных компонент платформы можно использовать следующие скрипты:

- Сервер БД - PostgresSQL 11 :

| **ОС**                        | **Команда / Скрипт**                                                                          |
|-------------------------------|-----------------------------------------------------------------------------------------------|
| RHEL 7 / CentOS 7 / Fedora 29 | source `<(curl -s https://download.lsfusion.org/yum/install-lsfusion4-db)`                    |
| Ubuntu 18 / Debian 9          | source `<(curl -s https://download.lsfusion.org/apt/install-lsfusion4-db)`<br/>PostgresSQL 10 |

- Сервер приложений - lsFusion 4 Server (+ OpenJDK 1.8):