---
title: 'Резервная копия'
---

Архивные копии делаются, как правило, в автоматическом режиме с помощью отдельного задания в планировщике. 
Тем не менее ряд операций, связанных с резервным копированием можно сделать и вручную на форме **Администрирование - Планировщик - Резервное копирование**. 
Вначале работы с системой необходимо на вкладке Настройки установить параметры (рис.1):

- **Директория Bin PostgreSQL** - задается путь к базе данных. Если в качестве операционной системы используется **Linux**, то формам ввода типа **/user/bin**, 
если **Windows**, то типа **C:\Program Files\PostgreSQL\Demo\bin\**.
- **Путь сохранения бэкапов PostgreSQL** - задается путь, где будут храниться созданные архивы.
- **Оставлять бэкап за первое число месяца (старше месяца)** - отметка в этом поле означает, что при удалении более ранних архивов 
(по кнопке **Проредить** на вкладке **Резервные копии**) не будут удаляться копии, созданные на первое число месяца.
- **Оставлять бэкап за понедельник (от недели до месяца)** - отметка в этом поле означает, что при удалении более ранних архивов 
(по кнопке **Проредить** на вкладке **Резервные копии**) не будут удаляться копии, созданные на первый день недели.
- **Максимальное число сохраняемых бэкапов** - максимальное количество архивных копий, которое остается на сервере после нажатия кнопки **Проредить** 
на вкладке **Резервные копии**. Если для данного поля не задано никакое значение, то, по умолчанию, считается 30 самых поздних бэкапов.

:::warning Внимание!
При совместном использовании отметок на оставляемые бэкапы и максимального числа копий, необходимо учитывать следующее:  
- Чтобы не удалялся архив на первый день недели, максимальное число копий должно быть не менее 8, при условии, что в день формируется один бэкап.
- Чтобы не удалялся архив на первый день месяца, максимальное число копий должно быть не менее 31, при условии, что в день формируется один бэкап.
:::

![](../img/backup1.png)  
Рис. 1 Настройки для резервного копирования  

На вкладке **Резервные копии** находятся основными инструменты по созданию и поддержанию архивных копий (рис. 2; 
далее в скобках указаны соответствующие маркеры на рис. 2):

- **Создать копию** (12) - создается архивная копия всех таблиц, используемых для конкретной логики. Список таблиц представлен в секции **Таблица** (2). 
В результате данного действия, в секции **Резервная копия** (1) появляется запись, содержащая Дату, Время, и Имя архивного файла.
- **Создать копию (оперативно)** (13)- в архив будут включены только те таблицы, у которых в секции **Таблицы**, 
в поле **Исключить из оперативного копирования** (9) нет отметки. Для оперативных бэкапов в списке резервных копий, в поле **Оперативная копия** (5) будет стоять отметка. 
Помимо полного резервного копирования, данный тип позволяет осуществлять дополнительную, промежуточную сохранность некоторых таблиц с часто меняемыми данным. 
Из-за меньших размеров, оперативную копию удобно использовать при отладке системы.
- **Скачать**(10) - можно скачать резервную копию на персональный компьютер. Есть ограничения на размер скачиваемого бэкапа – до 0,5 Гб.
- **Проредить** (11)- будут удалены самые ранние архивы сверх числа, указанного в настройках в поле **Максимальное число сохраняемых бэкапов**. 
Также будут учтены отметки **Оставлять бэкап за первое число месяца (старше месяца)** и **Оставлять бэкап за понедельник (от недели до месяца)** (рис. 1).

Если в любой из типов бэкапов (полный или оперативный), по какой-либо причине, попали не все нужные таблицы, 
в списке резервных копий, в поле **Не завершен** (7) будет стоять отметка. Архивы с данной отметкой не являются корректными и, как правило, подлежать удалению.

После физического удаления старого бэкапа (**Удалить** (8) или **Проредить** (11), в списке резервных копий остается запись с именем этого архива и отметкой **Файл удален** (6).

Для всех завершенных резервных копий в секции **Лог** (3) содержится информация о последовательности действий при создании архива.

В секции **Скопированные таблицы** (4) представлен фактический список таблиц для каждой резервной копии.

![](../img/backup2.png)  
Рис. 2 Инструменты управления для резервного копирования  

